\begin{tikzpicture}[namenode/.style={scale=1}]

    \coordinate (YFrontLowerLeft) at (0, 0);
    \coordinate (Ynamenoe) at ($(YFrontLowerLeft) + (\n/2, -\namedistance)$);
    
    \draw (YFrontLowerLeft) rectangle (\n, \m);

    \node[namenode] at (Ynamenoe) {$\mathcal{Y}\in \mathbb{R}^{m\times n \times r}$};

    % This scope draws the top face of the cube
    \begin{scope}[shift={(YFrontLowerLeft)}, canvas is zx plane at y=\m,rotate=\rot]
        \draw (0,0) rectangle (\n,\s);
    \end{scope}
    
    % This scope draws the left side of the cube
    \begin{scope}[shift={(YFrontLowerLeft)},canvas is zy plane at x=\n,rotate=90]
        \draw (0,0) rectangle (\m,\s); %
    \end{scope}

    \foreach \i in {1,...,\mslices} {
        \pgfmathsetmacro{\z}{\i*\m/\mslices}
        
        % Draw the lines in front of the cube
        \draw[ultra thin] (0,\z) -- (\n,\z);

        % Side face (ZY plane) - Shift lines correctly
        \begin{scope}[canvas is zy plane at x=\n]
            \draw[ultra thin] (0,\z) -- (-\s,\z);
        \end{scope}
    }

    % Draw slices (horizontal lines) on the front face
    \foreach \i in {1,...,\nslices} {
        \pgfmathsetmacro{\z}{\i*\n/\nslices}
        
        % Draw the lines in front of the cube
        \draw[ultra thin] (\z,0) -- (\z,\m);

        % Side face (ZY plane) - Shift lines correctly
        \begin{scope}[canvas is zx plane at y=\m]
            \draw[ultra thin] (0,\z) -- (-\s,\z);
        \end{scope}
    }

    \coordinate (equal_sign) at ($(YFrontLowerLeft) + (\n + \p/2 + 0.1, \m/2)$);
    \node[namenode] at (equal_sign) {$=$};

    \coordinate (XFrontLowerLeft) at ($(YFrontLowerLeft) + (\n + \p/2 + 0.2 + \distance, 0)$);
    \draw (XFrontLowerLeft) rectangle ($(XFrontLowerLeft) + (\n, \m)$);
    
    \coordinate (Xnamenode) at ($(XFrontLowerLeft) + (\n/2 + \p/2.75, -\namedistance)$);
    \node[namenode] at (Xnamenode) {$\mathcal{X}\in \mathbb{R}^{m\times n\times p}$};

    % This scope draws the top face of the cube
    \begin{scope}[shift={(XFrontLowerLeft)}, canvas is zx plane at y=\m,rotate=\rot]
        \draw (0,0) rectangle (\p,\n);
        \draw[-to, ultra thick] ($(\p/\pslices/2+0.05, \arrowdistancey-0.05)$) -- ($(\p/\pslices/2+0.05, \p-\arrowdistancey+0.05)$);


        \coordinate (ALowerLeft) at ($(0, \p + \distance+0.2)$);
        \draw (ALowerLeft) rectangle ($(ALowerLeft) + (\p, \s)$);
        \draw[-to, ultra thick] ($(ALowerLeft) + (\arrowdistancex+0.025, \arrowdistancex+0.2)$) -- ($(ALowerLeft) + (\p-\arrowdistancex-0.025, \arrowdistancex+0.2)$);
    \end{scope}
    
    \node[namenode] at ($(XFrontLowerLeft) + (1.35*\n, \m+\p)$) {$\mathbf{A}\in\mathbb{R}^{s\times p}$};
    % This scope draws the left side of the cube
    \begin{scope}[shift={(XFrontLowerLeft)},canvas is zy plane at x=\n,rotate=90]
        \draw (0,0) rectangle (\m,\p); %
    \end{scope}
    
    \begin{scope}[shift={(XFrontLowerLeft)}]
        \foreach \i in {1,...,\mslices} {
            \pgfmathsetmacro{\z}{\i*\m/\mslices}
            
            % Draw the lines in front of the cube
            \draw[ultra thin] (0,\z) -- (\n,\z);
    
            % Side face (ZY plane) - Shift lines correctly
            \begin{scope}[canvas is zy plane at x=\n]
                \draw[ultra thin] (0,\z) -- (-\p,\z);
            \end{scope}
        }
    
        \foreach \i in {1,...,\nslices} {
            \pgfmathsetmacro{\z}{\i*\n/\nslices}
            
            % Draw the lines in front of the cube
            \draw[ultra thin] (\z,0) -- (\z,\m);
    
            % Side face (ZY plane) - Shift lines correctly
            \begin{scope}[canvas is zx plane at y=\m]
                \draw[ultra thin] (0,\z) -- (-\p,\z);
            \end{scope}
        }
    
    \end{scope}

\end{tikzpicture}